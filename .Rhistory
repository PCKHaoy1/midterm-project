for(i in 1:dim(data)[2]){
col_items <- unique(data[,i])
# row_ex is the number of rows needed
# to make the column length conformable with items
row_ex <- nrows - dim(col_items)[1]
if(row_ex >= 0){
ex_rows <- tibble(rep(" ",row_ex))
colnames(ex_rows) <- colnames(col_items)
col_add <- rbind2(col_items, ex_rows)
} else if(row_ex < 0){
col_add <- col_items[1:10,]
}
items[,i] <- col_add
}
return(items)
}
#test <- show_unique(strawb, 10)
#|label: split strawb into census and survey pieces
strw_census <- strawb |> filter(Program == "CENSUS")
strw_survey <- strawb |> filter(Program == "SURVEY")
nrow(strawb) == (nrow(strw_census) + nrow(strw_survey))
#| label: examine Census and survey tibbles
#| warning: false
# Remove columns that contain only a single unique value
s_census <- strw_census |> drop_one_value_col(prt_val = TRUE)
s_survey <- strw_survey |> drop_one_value_col(prt_val = TRUE)
# Preview up to 10 unique values per column in each data set
unique_cen <- s_census |> show_unique(nrows = 10)
unique_sur <- s_survey |> show_unique(nrows = 10)
# Drop redundant or unnecessary Data
strw_census <- s_census |> select(-`State ANSI`)
# Remove 'State ANSI', 'Week Ending', and 'Period' for Data Cleaning
strw_survey <- s_survey |> select(-`State ANSI`, -`Week Ending`, -Period)
# Removing intermediate and temporary data set
rm(s_census, s_survey, strawberry, items)
# Starberries' grown place :)
state_all <- strawb |> distinct(State)
state_all1 <- strawb |> group_by(State) |> count()
# Improved bar plot
ggplot(state_all1, aes(x = reorder(State, -n), y = n)) +
geom_bar(stat = "identity", fill = "lightgreen", color = "black") +
labs(
title = "Strawberry Production by State",
x = "State",
y = "Number of Records"
) +
theme_minimal(base_size = 14) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(face = "bold", hjust = 0.5)
)
# Show unique values in the 'Domain' column from both datasets
unique(strw_census$Domain)
unique(strw_survey$Domain)
# Count number of records per Domain in Census
strw_census |>
count(Domain, sort = TRUE)
# Count number of records per Domain in Survey
strw_survey |>
count(Domain, sort = TRUE)
# First we check the use of Captan
# Filter rows from table1
captan_CA <- chemical_CA[str_detect(chemical_CA$`Domain Category`, regex("captan", ignore_case = TRUE)), ]
#Select all the rows that contains chemical useage information
chemical <- strw_survey[str_detect(strw_survey$`Domain Category`, regex("chemical", ignore_case = TRUE)),]
#Taking only CA and FL state data of chemical usage
chemical_CA <- chemical[chemical$State == "CALIFORNIA", ]
chemical_FL <- chemical[chemical$State == "FLORIDA", ]
print(chemical_CA)
print(chemical_FL)
rm(chemical)
# First we check the use of Captan
# Filter rows from table1
captan_CA <- chemical_CA[str_detect(chemical_CA$`Domain Category`, regex("captan", ignore_case = TRUE)), ]
# Filter rows from table2
captan_FL <- chemical_FL[str_detect(chemical_FL$`Domain Category`, regex("captan", ignore_case = TRUE)), ]
captan_combined <- rbind(captan_CA, captan_FL)
rm(captan_CA)
rm(captan_FL)
print(captan_combined)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <-  |> distinct(Year,)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <-  |> distinct(Year,)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <-  |> distinct(Year)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA1 <-  |> distinct(Year)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA1 <-  |> distinct(Year)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA1 <-  |> distinct(Year)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA1 <- captan_CA |> distinct(Year)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <- captan_combined |> distinct(Year)
captan_CA1 <- captan CA |> group_by(Category) |> count(value)
View(captan_CA)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <- captan_combined |> distinct(Year)
captan_CA1 <- captan CA |> group_by(Category) |> count()
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <- captan_combined |> distinct(Year)
captan_CA1 <- captan_CA |> group_by(Category) |> count()
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <- captan_combined |> group_by(Category) |> count(Value)
print(captan_CA)
View(captan_CA)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <- captan_combined |> group_by(Year + Category) |> count(Value)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan_CA <- captan_combined |> group_by(Year, Category) |> count(Value)
print(captan_CA)
View(captan_CA)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan <- captan_combined |> group_by(Year, Category, State) |> count(Value)
print(captan)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan <- captan_combined |> group_by(Category, State, Year) |> count(Value)
print(captan)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan <- captan_combined |> group_by(Category, State, Year) |> count(Value)
print(captan)
rm(captan_CA)
View(captan)
#Then we make a bar chart to compare the captan use in California and Florida
# remove commas and convert to numeric
df$Value <- as.numeric(gsub(",", "", df$Value))
#Then we make a bar chart to compare the captan use in California and Florida
captan$Value <- as.numeric(gsub(",", "", captan$Value))
captan$Group <- paste(captan$State, captan$Year, sep = "-")
agg_captan <- aggregate(Value ~ Group + Category, data = captan, sum, na.rm = TRUE)
library(ggplot2)
ggplot(agg_captan, aes(x = Group, y = Value, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total Value by State-Year and Category",
x = "State-Year",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Then we make a bar chart to compare the captan use in California and Florida
captan$Value <- as.numeric(gsub(",", "", captan$Value))
captan$Group <- paste(captan$State, captan$Year, sep = "-")
agg_captan <- aggregate(Value ~ Group + Category, data = captan, sum, na.rm = TRUE)
print(agg_captan)
library(ggplot2)
ggplot(agg_captan, aes(x = Group, y = Value, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total Value by State-Year and Category",
x = "State-Year",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Then we make a bar chart to compare the captan use in California and Florida
library(ggplot2)
ggplot(captan, aes(x = Group, y = Value, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total Value by State-Year and Category",
x = "State-Year",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(agg_data, aes(x = Group, y = Value, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ State) +
labs(title = "Total Value by State-Year and Category",
x = "State-Year",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(captan, aes(x = Group, y = Value, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ State) +
labs(title = "Total Value by State-Year and Category",
x = "State-Year",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Then we make a bar chart to compare the captan use in California and Florida
rm(agg_captan)
View(captan_combined)
# now we make a bar chart to compare the result, separate by state, Category, and year
# Step 2: Filter application data
captan <- captan_combined |> group_by(Category, Item, State, Year) |> count(Value)
print(captan)
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(captan, aes(x = Year + State , y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge") +
facet_grid(Category ~ State) +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(captan, aes(x = Year, State , y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge") +
facet_grid(Category ~ State) +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(captan, aes(x = State , y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge") +
facet_grid(Category ~ State) +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(captan, aes(x = State , y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge")  +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
ggplot(captan, aes(x = State, Year , y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge")  +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
captan_2021 <- captan[int_detect(captan$Year, regex(2021, ignore_case = TRUE)), ]
#Then we make a bar chart to compare the captan use in California and Florida
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
ggplot(captan, aes(x = State, Year , y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge")  +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge")  +
labs(title = "Total Value by Category and State Over Time",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = Item)) +
geom_bar(stat = "identity", position = "dodge")  +
labs(title = "Total Value by Category and State on 2021",
x = "Year",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
geom_text(aes(label = round(Value, 1)),
vjust = -0.5, size = 3,
position = position_dodge(width = 0.9)) +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2021)",
x = "State",
y = "Total Value") +
scale_fill_brewer(palette = "Set2") +
theme_minimal() +
theme(
strip.text = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
)
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = round(Value, 1)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3) +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2023)",
x = "State",
y = "Total Value") +
scale_fill_brewer(palette = "Set2") +
theme_minimal() +
theme(
strip.text = element_text(size = 10),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
)
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = position_dodge(width = 0.9)) +
geom_text(aes(label = round(Value, 1)),
position = position_dodge(width = 0.9),
vjust = -0.5, size = 3) +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2023)",
x = "State",
y = "Total Value")
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = Item, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total Value by Item and State (2021)",
x = "Item",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 2))
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = Item, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total Value by Item and State (2021)",
x = "Item",
y = "Total Value") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State per Item (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item,Category, scales = "free_y") +
labs(title = "Total Value by State (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, Category, scales = "free_y") +
labs(title = "Total Value by State (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
View(captan_2021)
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Category, Item, scales = "free_y") +
labs(title = "Total Value by State (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Item, scales = "free_y") +
labs(title = "Total Value by State (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Category + Item, scales = "free_y") +
labs(title = "Total Value by State (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
#Then we make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Category + Item, scales = "free_y") +
labs(title = "Total Value by State (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Category + Item, scales = "free_y") +
labs(title = "Total Value by State (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
View(captan_combined)
View(strw_survey)
#Then we can make a bar chart to compare the captan use in California and Florida
#Generate Data from 2021 and 2023
captan_2021 <- captan[str_detect(captan$Year, regex("2021", ignore_case = TRUE)), ]
captan_2023 <- captan[str_detect(captan$Year, regex("2023", ignore_case = TRUE)), ]
#Then we can make the graph (code perfection by chatgpt, for a better visual effect)
ggplot(captan_2021, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Category + Item, scales = "free_y") +
labs(title = "Total Value by State (2021)",
x = "State",
y = "Total Value") +
theme_minimal()
ggplot(captan_2023, aes(x = State, y = Value, fill = State)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Category + Item, scales = "free_y") +
labs(title = "Total Value by State (2023)",
x = "State",
y = "Total Value") +
theme_minimal()
rm(captan_2021,captan_2023)
View(chemical_CA)
